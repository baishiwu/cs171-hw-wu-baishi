<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <style>
  </style>
<body>

  <form name="myform">
    <div>
    Layout: 
      <select name="optone" onchange="setOptions(document.myform.optone.options[document.myform.optone.selectedIndex].value);">
        <option value="" selected="selected"></option>
        <option value="rankings">Rankings</option>
        <option value="scatterplot">Scatterplot</option>
      </select>
    </div>
    <div>
      Variable: <select name ="opttwo">
        <option value="" selected="selected">Select Layout First</option>
      </select>
    </div>
  </form>
  <div>
    <form action ="">
      Data Type: <input class="data_type" type="radio" name="Date" value="Ordinal" checked="checked">Ordinal
      <input class="data_type" type="radio" name="Date" value="Quantitative" checked="checked">Quantitative
    </form>
  </div>


  <script type="text/javascript">

  // Dynamically Change Inputs

    function setOptions(chosen) {
      var selbox = document.myform.opttwo;
       
      selbox.options.length = 0;
        if (chosen == "") {
          selbox.options[selbox.options.length] = new Option('Select Layout First',' ');
        }
        if (chosen == "rankings") {
          selbox.options[selbox.options.length] = new Option('Population');
          selbox.options[selbox.options.length] = new Option('GDP');
          selbox.options[selbox.options.length] = new Option('Life Expectancy');
        }
        if (chosen == "scatterplot") {
          selbox.options[selbox.options.length] = new Option('Population vs. GDP');
          selbox.options[selbox.options.length] = new Option('Longitude vs. Latitude');
        }
      }
 
  // Rankings

    var margin = {top: 10, bottom: 10, left:100, right: 40};
    var width = 900 - margin.left - margin.right;
    var height = 1500 - margin.top - margin.bottom;
    var padding = 30;

    var svg = d3.select("body")
                .append("svg")
                .attr("width", width+margin.left+margin.right)
                .attr("height", height+margin.top+margin.bottom);
  
    d3.json("data/countries_2012.json", function(data) {

        data.sort(function(a,b) { return b.population - a.population; })
 
        var xScale = d3.scale.linear()

        var yScale = d3.scale.linear()
          .domain([-90, d3.max(data, function(d) { return d.population; })])
          .range([height - padding, padding]);

        svg.selectAll("circle")
          .data(data)
          .enter()
          .append("circle")
          .attr("cx", 5)      
          .attr("cy", function(d) { return yScale(d.population); })      
          .attr("r", 5 );
    
        svg.selectAll("text")
          .data(data)
          .enter()
          .append("text")
          .text(function(d) { return d.name; })
          .attr("x", 15)
          .attr("y", function(d) { return yScale(d.population * .995); })
          .attr("font-family", "sans-serif")
          .attr("font-size", "10px")
    });

  // Change Actions

function ordinal_scale () {

    d3.json("data/countries_2012.json", function(data) {

        var yScale = d3.scale.ordinal()
          .domain(data.map(function(d) { return d.name; }))

        svg.selectAll("circle")
          .transition().duration(500)
          .attr("cy", function(d, i) { return i * 12 + padding / 2; })      
        
        svg.selectAll("text")
          .transition().duration(500)        
          .attr("y", function(d, i) { return i * 12 + padding / 2; })
    })
  }

function quantitative_scale () {

    d3.json("data/countries_2012.json", function(data) {

        var yScale = d3.scale.linear()
          .domain([-90, d3.max(data, function(d) { return d.population; })])

        svg.selectAll("circle")
          .transition().duration(500)        
          .attr("cy", function(d) { return yScale(d.population); })      
        
        svg.selectAll("text")
          .transition().duration(500)        
          .attr("y", function(d) { return yScale(d.population * .995); })
    })
  }

function gdp_input () {
    d3.json("data/countries_2012.json", function(data) {

        data.sort(function(a,b) { return b.gdp - a.gdp; })  
        var yScale = d3.scale.linear()
          .domain([-90, d3.max(data, function(d) { return d.gdp; })])

        svg.selectAll("circle")
          .attr("cy", function(d) { return yScale(d.gdp); })      

        svg.selectAll("text")
          .attr("y", function(d) { return yScale(d.gdp * .995); })

    })
  }

function variable_selector_rankings () {
        data.sort(function(a,b) { return b.gdp - a.gdp; })  
        var yScale = d3.scale.linear()
          .domain([-90, d3.max(data, function(d) { return d.gdp; })])

        svg.selectAll("circle")
          .attr("cy", function(d) { return yScale(d.gdp); })      

        svg.selectAll("text")
          .attr("y", function(d) { return yScale(d.gdp * .995); })
}

function variable_selector_scatterplot_geo () {

    d3.json("data/countries_2012.json", function(data) {
  
        var xScale = d3.scale.linear()
          .domain([-90, d3.max(data, function(d) { return d.longitude; })])
          .range([padding, width - padding * 2]);

        var yScale = d3.scale.linear()
          .domain([-90, d3.max(data, function(d) { return d.latitude; })])
          .range([height - padding, padding]);

        svg.selectAll("circle")
          .transition().duration(500)                
          .attr("cx", function(d) { return xScale(d.longitude); })      
          .attr("cy", function(d) { return yScale(d.latitude); })      

        svg.selectAll("text")
          .transition().duration(500)                
          .attr("x", function(d) { return xScale(d.longitude); })
          .attr("y", function(d) { return yScale(d.latitude); })
    })
}

function variable_selector_scatterplot_pop () {

    d3.json("data/countries_2012.json", function(data) {
  
        var xScale = d3.scale.linear()
          .domain([-90, d3.max(data, function(d) { return d.population; })])
          .range([padding, width - padding * 2]);

        var yScale = d3.scale.linear()
          .domain([-90, d3.max(data, function(d) { return d.gdp; })])
          .range([height - padding, padding]);

        svg.selectAll("circle")
          .transition().duration(500)                
          .attr("cx", function(d) { return xScale(d.population); })      
          .attr("cy", function(d) { return yScale(d.gdp); })      

        svg.selectAll("text")
          .transition().duration(500)                
          .attr("x", function(d) { return xScale(d.population); })
          .attr("y", function(d) { return yScale(d.gdp); })
    })
}

d3.select("input[value=Ordinal]").on("click", variable_selector_scatterplot_geo);
d3.select("input[value=Quantitative]").on("click", variable_selector_scatterplot_pop);
d3.select("option[value=rankings]").on("change", quantitative_scale);
d3.select("option[value=scatterplot]").on("change", quantitative_scale);
d3.select("option[value=population]").on("change", quantitative_scale);
d3.select("option[value=gdp]").on("change", quantitative_scale);
d3.select("option[value=life]").on("change", quantitative_scale);
d3.select("option[value=popvsgdp]").on("change", quantitative_scale);
d3.select("option[value=geo]").on("change", quantitative_scale);

  </script>
</body>